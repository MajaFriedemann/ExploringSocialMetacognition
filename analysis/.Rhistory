geom_smooth(aes(colour = pid, group = pid), method = 'lm', alpha = 0.1, se = F) +
geom_point(aes(colour = pid), alpha = 0.2) +
stat_summary(geom = 'point', fun.y = mean, shape = 95, size = 6) +
stat_summary(geom = 'errorbar', fun.data = mean_cl_boot, width = 0.4) +
facet_grid(early ~ typeName, labeller = label_both) +
style.long
ggplot(tmp[tmp$initialCorrect, ],
aes(x = confidenceCategory, y = initialConfidence)) +
geom_smooth(aes(colour = pid, group = pid), method = 'lm', alpha = 0.1, se = F) +
stat_summary(geom = 'point', fun.y = mean, shape = 95, size = 6) +
stat_summary(geom = 'errorbar', fun.data = mean_cl_boot, width = 0.4) +
facet_grid(early ~ typeName, labeller = label_both) +
style.long
ggplot(tmp[tmp$initialCorrect, ],
aes(x = confidenceCategory, y = initialConfidence)) +
geom_smooth(aes(colour = pid, group = pid), method = 'lm', alpha = 0.1, se = F) +
stat_summary(geom = 'point', fun.y = mean, shape = 95, size = 6) +
stat_summary(geom = 'errorbar', fun.data = mean_cl_boot, width = 0.4, size = 1.5) +
facet_grid(early ~ typeName, labeller = label_both) +
style.long
ggplot(tmp[tmp$initialCorrect, ],
aes(x = confidenceCategory, y = initialConfidence)) +
geom_smooth(aes(colour = pid, group = pid), method = 'lm', alpha = 0.1, se = F) +
stat_summary(geom = 'point', fun.y = mean, shape = 18, size = 4) +
stat_summary(geom = 'errorbar', fun.data = mean_cl_boot, width = 0.2, size = 1.2) +
facet_grid(early ~ typeName, labeller = label_both) +
style.long
ggplot(tmp[tmp$initialCorrect, ],
aes(x = confidenceCategory, y = initialConfidence)) +
geom_smooth(aes(colour = pid, group = pid), method = 'lm', alpha = 0.1, se = F) +
stat_summary(geom = 'point', fun.y = mean, shape = 18, size = 2) +
stat_summary(geom = 'errorbar', fun.data = mean_cl_boot, width = 0.2, size = 1) +
facet_grid(early ~ typeName, labeller = label_both) +
style.long
# the problem: poorly differentiated aggreement rates in forced trials ####
ggplot(tmp[tmp$initialCorrect, ],
aes(x = confidenceCategory, y = as.numeric(advisorAgrees), colour = adviceType, fill = adviceType)) +
stat_summary(geom = 'point', fun.y = mean, size = 2, alpha = 0.5) +
stat_summary(geom = 'errorbar', fun.data = mean_cl_boot, width = 0.25) +
facet_grid(early ~ type, labeller = label_both) +
style
library(gganimate)
install.packages('gganimate')
install.packages(c("ggplot2", "gganimate", "BayesFactor", "lsr", "tidyverse"))
if(!require(jsonlite)) {
install.packages("jsonlite")
library(jsonlite)
}
if(!require(BayesFactor)) {
install.packages('BayesFactor')
library(BayesFactor)
}
if(!require(tidyverse)) {
install.packages('tidyverse')
library(tidyverse)
}
if(!require(reshape2)) {
install.packages('reshape2')
library(reshape2)
}
if(!require(lme4)) {
install.packages('lme4')
library(lme4)
}
if(!require(lsr)) {
install.packages('lsr')
library(lsr)
}
library(lme4)
library(gganimate)
install.packages('gganimate')
devtools::install_github('thomasp85/gganimate')
install.packages('devtools')
devtools::install_github('thomasp85/gganimate')
devtools::install_github('thomasp85/gganimate')
install.packages('tweenr')
install.packages('transformr')
devtools::install_github('thomasp85/gganimate')
# Set path of Rtools
Sys.setenv(PATH = paste(Sys.getenv("PATH"), "*InstallDirectory*/Rtools/bin/",
"*InstallDirectory*/Rtools/mingw_64/bin", sep = ";")) #for 64 bit version
Sys.setenv(BINPREF = "*InstallDirectory*/Rtools/mingw_64/bin")
library(devtools)
#Manually "force" version to be accepted
assignInNamespace("version_info", c(devtools:::version_info, list("3.5" = list(version_min = "3.3.0", version_max = "99.99.99", path = "bin"))), "devtools")
find_rtools() # is TRUE now
# Now you can install transformr then gganimate
devtools::install_github("thomasp85/transformr")
devtools::install_github("dgrtwo/gganimate")
# the problem: poorly differentiated aggreement rates in forced trials ####
ggplot(tmp[tmp$initialCorrect, ],
aes(x = confidenceCategory, y = as.numeric(advisorAgrees), colour = adviceType, fill = adviceType)) +
stat_summary(geom = 'point', fun.y = mean, size = 2, alpha = 0.5) +
stat_summary(geom = 'errorbar', fun.data = mean_cl_boot, width = 0.25) +
facet_grid(early ~ type, labeller = label_both) +
style
tmp <- trials
for(v in c('pid','confidenceCategory','adviceType'))
tmp[ ,v] <- as.factor(tmp[ ,v])
tmp$early <- tmp$id < 150
# the problem: poorly differentiated aggreement rates in forced trials ####
ggplot(tmp[tmp$initialCorrect, ],
aes(x = confidenceCategory, y = as.numeric(advisorAgrees), colour = adviceType, fill = adviceType)) +
stat_summary(geom = 'point', fun.y = mean, size = 2, alpha = 0.5) +
stat_summary(geom = 'errorbar', fun.data = mean_cl_boot, width = 0.25) +
facet_grid(early ~ type, labeller = label_both) +
style
install.packages('Hmisc')
# the problem: poorly differentiated aggreement rates in forced trials ####
ggplot(tmp[tmp$initialCorrect, ],
aes(x = confidenceCategory, y = as.numeric(advisorAgrees), colour = adviceType, fill = adviceType)) +
stat_summary(geom = 'point', fun.y = mean, size = 2, alpha = 0.5) +
stat_summary(geom = 'errorbar', fun.data = mean_cl_boot, width = 0.25) +
facet_grid(early ~ type, labeller = label_both) +
style
# the problem: poorly differentiated aggreement rates in forced trials ####
g <- ggplot(tmp[tmp$initialCorrect, ],
aes(x = confidenceCategory, y = as.numeric(advisorAgrees), colour = adviceType, fill = adviceType, frame = id)) +
stat_summary(geom = 'point', fun.y = mean, size = 2, alpha = 0.5) +
stat_summary(geom = 'errorbar', fun.data = mean_cl_boot, width = 0.25) +
facet_grid(early ~ type, labeller = label_both) +
style
gganimate(g)
animate(g)
library(gganimate)
animate(g)
# the problem: poorly differentiated aggreement rates in forced trials ####
g <- ggplot(tmp[tmp$initialCorrect, ],
aes(x = confidenceCategory, y = as.numeric(advisorAgrees), colour = adviceType, fill = adviceType, frame = id)) +
stat_summary(geom = 'point', fun.y = mean, size = 2, alpha = 0.5) +
stat_summary(geom = 'errorbar', fun.data = mean_cl_boot, width = 0.25) +
facet_grid(early ~ type, labeller = label_both) +
style +
transition_states(
id,
transition_length = 2,
state_length = 1
)
# the problem: poorly differentiated aggreement rates in forced trials ####
ggplot(tmp[tmp$initialCorrect, ],
aes(x = confidenceCategory, y = as.numeric(advisorAgrees), colour = adviceType, fill = adviceType, frame = id)) +
stat_summary(geom = 'point', fun.y = mean, size = 2, alpha = 0.5) +
stat_summary(geom = 'errorbar', fun.data = mean_cl_boot, width = 0.25) +
facet_grid(early ~ type, labeller = label_both) +
style +
transition_states(
id,
transition_length = 2,
state_length = 1
)
gganimate(g, title_frame = T)
# the problem: poorly differentiated aggreement rates in forced trials ####
g<- ggplot(tmp[tmp$initialCorrect, ],
aes(x = confidenceCategory, y = as.numeric(advisorAgrees),
colour = adviceType, fill = adviceType,
frame = id, cumulative = T)) +
stat_summary(geom = 'point', fun.y = mean, size = 2, alpha = 0.5) +
stat_summary(geom = 'errorbar', fun.data = mean_cl_boot, width = 0.25) +
facet_grid(early ~ type, labeller = label_both) +
style
animate(g, title_frame = T)
tmp.2 <- NULL
for(i in 1:60) {
for(choice in unique(tmp$type)){
type = ifelse(choice==1, 'Forced', 'Choice')
for(early in unique(tmp$early)) {
order = ifelse(early, 'First', 'Last')
v <- tmp[tmp$type == choice & tmp$early == early, c('id', 'advisorAgrees')]
v <- v[order(v$id), ]
v <- v[1:i,'advisorAgrees']
mu <- mean(as.numeric(v))
cl <- mean_cl_boot(v)
tmp.2 <- rbind(tmp.2, data.frame(trialNum = i,
type,
order,
mu,
y.min = cl$ymin,
y.max = cl$ymax))
}
}
}
tmp.2 <- NULL
for(i in 1:60) {
for(choice in unique(tmp$type)){
type = ifelse(choice==1, 'Forced', 'Choice')
for(early in unique(tmp$early)) {
for(cc in unique(tmp$confidenceCategory)) {
order = ifelse(early, 'First', 'Last')
v <- tmp[tmp$type == choice & tmp$early == early & tmp$confidenceCategory==cc, c('id', 'advisorAgrees')]
v <- v[order(v$id), ]
v <- v[1:i,'advisorAgrees']
mu <- mean(as.numeric(v))
cl <- mean_cl_boot(v)
tmp.2 <- rbind(tmp.2, data.frame(trialNum = i,
confidenceCategory = cc,
type,
order,
mu,
y.min = cl$ymin,
y.max = cl$ymax))
}
}
}
}
tmp.2 <- NULL
for(i in 1:60) {
for(choice in unique(tmp$type)){
type = ifelse(choice==1, 'Forced', 'Choice')
for(early in unique(tmp$early)) {
for(cc in unique(tmp$confidenceCategory)) {
for(adviceType in unique(tmp$adviceType)) {
order = ifelse(early, 'First', 'Last')
v <- tmp[tmp$type == choice & tmp$early == early & tmp$confidenceCategory==cc & tmp$adviceType==adviceType,
c('id', 'advisorAgrees')]
v <- v[order(v$id), ]
v <- v[1:i,'advisorAgrees']
mu <- mean(as.numeric(v))
cl <- mean_cl_boot(v)
tmp.2 <- rbind(tmp.2, data.frame(trialNum = i,
confidenceCategory = cc,
type,
order,
adviceType,
mu,
y.min = cl$ymin,
y.max = cl$ymax))
}
}
}
}
}
g <- ggplot(tmp.2, aes(x = confidenceCategory, y = mu, colour = adviceType, frame = trialNum)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(y.min = y.min, y.max = y.max)) +
facet_grid(type ~ order, labeller = label_both) +
style
g <- ggplot(tmp.2, aes(x = confidenceCategory, y = mu, colour = adviceType, frame = trialNum)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = y.min, ymax = y.max)) +
facet_grid(type ~ order, labeller = label_both) +
style
g
# animated version of the problem ####
tmp.2 <- NULL
for(i in 1:60) {
for(choice in unique(tmp$type)){
type = ifelse(choice==1, 'Forced', 'Choice')
for(early in unique(tmp$early)) {
for(cc in unique(tmp$confidenceCategory)) {
for(adviceType in unique(tmp$adviceType)) {
order = ifelse(early, 'First', 'Last')
v <- tmp[tmp$type == choice & tmp$early == early & tmp$confidenceCategory==cc & tmp$adviceType==adviceType,
c('id', 'advisorAgrees')]
v <- v[order(v$id), ]
v <- v[1:i,'advisorAgrees']
meanAgreement <- mean(as.numeric(v))
cl <- mean_cl_boot(v)
tmp.2 <- rbind(tmp.2, data.frame(trialNum = i,
confidenceCategory = cc,
type,
order,
adviceType,
meanAgreement,
ymin = cl$ymin,
ymax = cl$ymax))
}
}
}
}
}
g <- ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType, frame = trialNum)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style
animate(g)
ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
transition_states(trialNum)
ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
transition_states(trialNum, transition_length = 1)
ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
transition_states(trialNum, transition_length = 1, state_length = 1)
ggplot(airquality, aes(Day, Temp)) +
geom_line(size = 2, colour = 'steelblue') +
transition_states(Month, 4, 1) +
shadow_mark(size = 1, colour = 'grey')
names(airquality)
ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
transition_states(trialNum, transition_length = 4, state_length = 1)
unique(airquality$Month)
animate(g)
animate(g, renderer = ffmpeg_renderer())
g <- ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
transition_states(trialNum, transition_length = 4, state_length = 1)
animate(g, renderer = ffmpeg_renderer())
ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
labs(title = 'Trials 1:{frame_state}') +
transition_states(trialNum, transition_length = 4, state_length = 1)
ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
labs(title = 'Trials 1:{frame_time}') +
transition_time(trialNum, transition_length = 4, state_length = 1)
ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
labs(title = 'Trials 1:{frame_time}') +
transition_time(trialNum)
?transition_time
ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
labs(title = 'Trials 1:{closest_state}') +
transition_states(trialNum, transition_length = 1, state_length = 2, wrap = F)
ggplot(iris, aes(Sepal.Width, Petal.Width)) +
geom_point() +
labs(title = "{closest_state}") +
transition_states(Species, transition_length = 3, state_length = 1)
ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
labs(title = 'Trials 1:{closest_state}') +
transition_states(as.factor(trialNum), transition_length = 1, state_length = 2, wrap = F)
?transition_manual
ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
labs(title = 'Trials 1:{current_frame}') +
transition_manual(as.factor(trialNum), transition_length = 1, state_length = 2, wrap = F)
ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
labs(title = 'Trials 1:{current_frame}') +
transition_manual(as.factor(trialNum))
ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
labs(title = 'Trials 1:{current_frame}') +
transition_manual(trialNum)
unique(tmp.2$trialNum)
which(tmp.2$trialNum==60)
ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
labs(title = 'Trials 1:{frame_time}') +
transition_time(trialNum)
options(interval = 2)
ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
labs(title = 'Trials 1:{frame_time}') +
transition_time(trialNum)
g <- ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
labs(title = 'Trials 1:{frame_time}') +
transition_time(trialNum) +
enter_fade()
animate(g,nframes = 60, fps = 2)
animate(g,nframes = 60, fps = 20, detail = 10)
animate(g,nframes = 600, fps = 20, detail = 10)
# animated version of the problem ####
tmp.2 <- NULL
for(i in 1:60) {
for(choice in unique(tmp$type)){
type = ifelse(choice==1, 'Forced', 'Choice')
for(early in unique(tmp$early)) {
for(cc in unique(tmp$confidenceCategory)) {
for(adviceType in unique(tmp$adviceType)) {
order = ifelse(early, 'First', 'Last')
v <- tmp[tmp$type == choice & tmp$early == early & tmp$confidenceCategory==cc & tmp$adviceType==adviceType,
c('id', 'advisorAgrees')]
v <- v[order(v$id), ]
v <- v[1:i,'advisorAgrees']
meanAgreement <- mean(as.numeric(v))
cl <- mean_cl_boot(v)
tmp.2 <- rbind(tmp.2, data.frame(trialNum = i,
confidenceCategory = cc,
type,
order,
adviceType = getAdviceTypeName(adviceType),
meanAgreement,
ymin = cl$ymin,
ymax = cl$ymax))
}
}
}
}
}
g <- ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
style +
labs(title = 'Trials 1:{frame_time}') +
transition_time(trialNum) +
enter_fade() +
ease_aes('sine-in-out')
animate(g,nframes = 600, fps = 20, detail = 10)
g <- ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
scale_y_discrete(name='Confidence category', levels = c('Low', 'Med', 'High')) +
scale_x_continuous(name= 'Mean agreement') +
scale_color_discrete(name= 'Advice type', levels = c('Agree-in-uncertainty', 'Agree-in-confidence')) +
style +
labs(title = 'Trials 1:{frame_time}') +
transition_time(trialNum) +
enter_fade() +
ease_aes('sine-in-out')
g <- ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
scale_y_discrete(name='Confidence category', labels = c('Low', 'Med', 'High')) +
scale_x_continuous(name= 'Mean agreement') +
scale_color_discrete(name= 'Advice type', levels = c('Agree-in-uncertainty', 'Agree-in-confidence')) +
style +
labs(title = 'Trials 1:{frame_time}') +
transition_time(trialNum) +
enter_fade() +
ease_aes('sine-in-out')
g <- ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
scale_y_discrete(name='Confidence category', labels = c('Low', 'Med', 'High')) +
scale_x_continuous(name= 'Mean agreement') +
scale_color_discrete(name= 'Advice type', labels = c('Agree-in-uncertainty', 'Agree-in-confidence')) +
style +
labs(title = 'Trials 1:{frame_time}') +
transition_time(trialNum) +
enter_fade() +
ease_aes('sine-in-out')
animate(g,nframes = 600, fps = 20, detail = 10)
g <- ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
scale_y_discrete(name='Confidence category', labels = c('Low', 'Med', 'High')) +
scale_color_discrete(name= 'Advice type', labels = c('Agree-in-uncertainty', 'Agree-in-confidence')) +
style +
labs(title = 'Trials 1:{frame_time}', x = 'mean(Agreement)') +
transition_time(trialNum) +
enter_fade() +
ease_aes('sine-in-out')
animate(g,nframes = 600, fps = 20, detail = 10)
g <- ggplot(tmp.2, aes(x = confidenceCategory, y = meanAgreement, colour = adviceType)) +
geom_point(shape = 18, size = 4) +
geom_errorbar(aes(ymin = ymin, ymax = ymax)) +
facet_grid(type ~ order, labeller = label_both) +
scale_x_discrete(name='Confidence category', labels = c('Low', 'Med', 'High')) +
scale_y_continuous(name= 'Mean agreement') +
scale_color_discrete(name= 'Advice type', labels = c('Agree-in-uncertainty', 'Agree-in-confidence')) +
style +
labs(title = 'Trials 1:{frame_time}') +
transition_time(trialNum) +
enter_fade() +
ease_aes('sine-in-out')
animate(g,nframes = 600, fps = 20, detail = 10)
?bartlett.test
InsectSprays$spray
InsectSprays$count
tmp <- data.frame(hc = round(rnorm(50,50,10)), d = round(rnorm(50,50,10)))
bartlett.test(tmp$hc, tmp$d)
bartlett.test(hc ~ d, data = tmp)
bartlett.test(list(tmp$hc, tmp$d))
