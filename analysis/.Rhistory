PrefBenevolence = tmp.2$benevolence[tmp.2$adviceType==aid] - tmp.2$benevolence[tmp.2$adviceType!=aid]
PrefLikeabilityDiff = tmp.2$likeabilityDiff[tmp.2$adviceType==aid] - tmp.2$likeabilityDiff[tmp.2$adviceType!=aid]
PrefAbilityDiff = tmp.2$abilityDiff[tmp.2$adviceType==aid] - tmp.2$abilityDiff[tmp.2$adviceType!=aid]
PrefBenevolenceDiff = tmp.2$benevolenceDiff[tmp.2$adviceType==aid] - tmp.2$benevolenceDiff[tmp.2$adviceType!=aid]
df.xiii <- rbind(df.xiii,
data.frame(pid, PrefStrength, PrefLikeability, PrefAbility, PrefBenevolence,
PrefLikeabilityDiff, PrefAbilityDiff, PrefBenevolenceDiff))
}
}
df.xiii <- aggregate(. ~ pid, df.xiii, FUN = mean)
df.xiii.2 <- NULL
for(v in c('Likeability', 'Ability', 'Benevolence')) {
x <- cor.test(df.xiii[ ,paste0('Pref',v)], df.xiii$PrefStrength)
bf <- correlationBF(df.xiii[ ,paste0('Pref',v)], df.xiii$PrefStrength)
x2 <- cor.test(df.xiii[ ,paste0('Pref',v,'Diff')], df.xiii$PrefStrength)
bf2 <- correlationBF(df.xiii[ ,paste0('Pref',v,'Diff')], df.xiii$PrefStrength)
df.xiii.2 <- rbind(df.xiii.2,
data.frame(v, 'Correlation'=x$estimate, 'p'=x$p.value, 'BF'=exp(bf@bayesFactor$bf),
'DiffCorrelation'=x2$estimate, 'pDiff'=x2$p.value, 'DiffBF'=exp(bf2@bayesFactor$bf)))
}
kable(df.xiii.2)
# 12) Predicting advisor from confidence ####
print('12 Predicting advisor from confidence')
df.xii <- NULL
for(pid in unique(trials$pid)) {
tmp <- trials[trials$pid==pid, ]
tmp$adviceType <- as.factor(tmp$adviceType)
ans <- glm(adviceType ~ initialConfidence, tmp, family = binomial(link = "logit"))
s <- summary(ans)
df.xii <- rbind(df.xii, data.frame(pid,
coef = s$coefficients[2,1],
p = s$coefficients[2,4]))
}
tmp <- df.xii
names(tmp)[2] <- 'y'
tmp$x <- 0
gg.xii <- ggplot(tmp, aes(x = p)) + geom_freqpoly(binwidth = 0.1)
gg.xii
# 13) Influence strength by confidence category ####
print('13 Influence strength by confidence category')
tmp <- aggregate(influence ~ confidenceCategory + pid, data = trials, FUN = mean)
gg.xiii <- ggplot(tmp, aes(x = confidenceCategory, y = influence)) +
geom_point(aes(colour = as.factor(pid)), alpha = 0.5) +
geom_smooth(method = 'lm',
aes(group = as.factor(pid), colour = as.factor(pid)),
se = F,
alpha = 0.2) +
stat_summary(geom = 'errorbar', fun.data = mean_cl_boot) +
style.long
gg.xiii
summary(aov(influence ~ confidenceCategory, data = tmp))
# 14) Confidence autocorrelation plots by participant ####
for(pid in unique(trials$pid)) {
tmp <- trials[trials$pid == pid, ]
ggplot(tmp, aes(x = initialConfSpan, y = finalConfSpan)) +
geom_polygon(data = df.poly1, aes(x,y), fill = 'grey', alpha = 0.2) +
geom_polygon(data = df.poly2, aes(x,y), fill = 'grey', alpha = 0.2) +
geom_point(alpha = 0.2, aes(color = factor(finalCorrect))) +
geom_abline(slope = 1, intercept = 0, linetype = 'dashed', size = 1, color = 'black') +
scale_color_discrete(name = 'Final judgement', labels = c('Incorrect', 'Correct')) +
scale_x_continuous(limits = c(-50,50), expand = c(0,0)) +
scale_y_continuous(limits = c(-50,50), expand = c(0,0)) +
facet_grid(~advisorAgrees, labeller = as_labeller(c('FALSE'='Disagree', 'TRUE'='Agree'))) +
labs(title = paste('PID:', pid, 'Initial vs final confidence'),
legend = NULL,
x = 'Initial confidence',
y = "Final confidence") +
coord_fixed() +
style +
theme(panel.spacing = unit(1.5, 'lines'),
plot.margin = unit(c(0,1,0,0.5), 'lines'))
#ggsave(paste0('explore/autocorrelations/pid', pid, '.png'), width = 8.96, height = 5.97, units = 'in')
}
# 15) Examining dot difference ####
library(gganimate)
g <- ggplot(trials, aes(x = id, y = dotDifference)) +
geom_line() +
geom_smooth(method = 'lm') +
scale_x_continuous(limits = c(0,246)) +
style.long +
labs(title = 'Participant {frame_time}') +
transition_time(pid)
animate(g, fps = 1)
df.cumAcc <- NULL
limit <- 0
for(pid in unique(all.trials$pid)) {
tmp <- all.trials[all.trials$pid == pid & all.trials$id > limit & all.trials$practice==F, ]
for(id in unique(tmp$id)) {
df.cumAcc <- rbind (df.cumAcc, data.frame(pid = as.factor(pid),
id,
cumAcc = mean(tmp$initialCorrect[tmp$id<=id])))
}
}
gg.cumAcc <- ggplot(df.cumAcc, aes(x = id, y = cumAcc, colour = pid)) +
geom_line(alpha = 0.25) +
stat_summary(geom = 'line', fun.y = mean, colour = 'red') +
stat_summary(geom = 'ribbon', fun.data = mean_cl_normal, colour = NA, fill = 'red', alpha = 0.05) +
annotate(geom = 'text', label = c('Mean', 'CL95% Low', 'CL95% High'),
y = c(.625,.575,.525), x = 230, hjust = 1) +
annotate(geom = 'text',
label = paste(round(mean_cl_normal(df.cumAcc$cumAcc[df.cumAcc$id==max(df.cumAcc$id)]),3)),
y = c(.625,.575,.525), x = 240) +
geom_hline(yintercept = .71, linetype = 'dashed', colour = 'black', size = 1) +
scale_y_continuous(limits=c(0.5,1),breaks=seq(0,1,.05)) +
style.long +
labs(title = 'Cumulative accuracy plot for participants in the Advisor Choice (accuracy) task')
gg.cumAcc
rawString <- '5669ac845bd4ff0011159b4a
17/09/2018, 17:43
01:12:43
MX5PC2Z4
AWAITING REVIEW
569c67f89e8363000c2ffcfc
17/09/2018, 17:42
00:47:22
MX5PC2Z4
AWAITING REVIEW
56a757a95ad8d9000c970c76
17/09/2018, 13:41
00:51:35
MX5PC2Z4
AWAITING REVIEW
56de005e6893b5000ce95d71
17/09/2018, 13:42
00:41:58
MX5PC2Z4
AWAITING REVIEW
56e6a66af6ed900006a5867c
17/09/2018, 04:37
00:55:43
MX5PC2Z4
AWAITING REVIEW
56fad9e4997828000c802706
17/09/2018, 17:42
00:53:22
MX5PC2Z4
AWAITING REVIEW
571a861d838a4e0013b1860a
17/09/2018, 19:49
00:43:32
MX5PC2Z4
AWAITING REVIEW
5749a01b5e5491000e3c4cc1
17/09/2018, 01:09
N/A
TIMED-OUT
577d11f88b3e2300016d74a0
17/09/2018, 19:42
00:45:27
MX5PC2Z4
AWAITING REVIEW
578673a9275be6000135880e
17/09/2018, 17:44
01:22:01
MX5PC2Z4
AWAITING REVIEW
57a81709fa44650001140cdd
17/09/2018, 19:45
00:59:48
MX5PC2Z4
AWAITING REVIEW
5817fda1b780e20001f3577a
17/09/2018, 12:14
00:37:07
MX5PC2Z4
AWAITING REVIEW
5825ecee95f3030001cf889a
17/09/2018, 01:08
00:33:21
MX5PC2Z4
AWAITING REVIEW
5842eb2904e7550001a06b14
17/09/2018, 19:54
00:31:07
MX5PC2Z4
AWAITING REVIEW
58ed33eced40190001e8a251
16/09/2018, 22:59
00:58:30
MX5PC2Z4
AWAITING REVIEW
590660a604ddca0001c8b18b
17/09/2018, 17:45
01:07:39
MX5PC2Z4
AWAITING REVIEW
593533d4ed2e9a0001d37c0b
17/09/2018, 17:42
00:48:32
MX5PC2Z4
AWAITING REVIEW
594c1e5a9160cb00011d6474
17/09/2018, 13:42
00:39:28
MX5PC2Z4
AWAITING REVIEW
597785e9aba92e000181e89e
17/09/2018, 13:42
00:37:53
MX5PC2Z4
AWAITING REVIEW
59b044b4d98aab00019bad5a
17/09/2018, 17:42
00:33:14
MX5PC2Z4
AWAITING REVIEW
59d4e028115096000190dc7f
17/09/2018, 13:42
00:52:30
MX5PC2Z4
AWAITING REVIEW
59e29e405de9b000017ecebf
17/09/2018, 17:42
00:36:35
MX5PC2Z4
AWAITING REVIEW
5a051341ff266c0001d1f915
17/09/2018, 01:09
10:42:47
Manual Completion
APPROVED
5a0fee41fdf6fc0001279511
17/09/2018, 19:42
00:37:01
MX5PC2Z4
AWAITING REVIEW
5a32e703c862ce00011155f6
17/09/2018, 19:45
00:58:10
MX5PC2Z4
AWAITING REVIEW
5a52a04cacc75b000179cd4c
17/09/2018, 12:14
01:10:55
MX5PC2Z4
AWAITING REVIEW
5a5e2307f6c5170001952f95
17/09/2018, 19:42
N/A
RETURNED
5a69257731b87a0001c76293
17/09/2018, 21:43
00:37:02
MX5PC2Z4
AWAITING REVIEW
5a69335363394a000155db5e
17/09/2018, 13:42
00:58:55
MX5PC2Z4
AWAITING REVIEW
5a78dbb9ae9a0b0001a97212
17/09/2018, 01:09
00:33:11
MX5PC2Z4
AWAITING REVIEW
5a7b73b5f1408d0001762c95
17/09/2018, 17:42
00:36:55
MX5PC2Z4
AWAITING REVIEW
5a8c970daa46dd00016be578
17/09/2018, 17:41
00:37:26
MX5PC2Z4
AWAITING REVIEW
5a9012adf053610001718912
17/09/2018, 12:14
00:25:06
MX5PC2Z4
AWAITING REVIEW
5a993b151eda410001365a23
17/09/2018, 17:43
00:44:39
MX5PC2Z4
AWAITING REVIEW
5aa7bd514eecca0001de02d8
17/09/2018, 13:41
00:56:17
MX5PC2Z4
AWAITING REVIEW
5aac1e34899a3b000167fd5d
17/09/2018, 13:41
01:00:06
MX5PC2Z4
AWAITING REVIEW
5aad8499e1546900019aef29
17/09/2018, 17:45
01:16:19
Manual Completion
APPROVED
5ab2706b0527ba0001c150d6
17/09/2018, 17:42
00:42:05
MX5PC2Z4
AWAITING REVIEW
5ab58ac0ead3eb0001518609
17/09/2018, 01:08
N/A
RETURNED
5ad35bcdfb109b0001a32b20
17/09/2018, 17:43
00:34:30
MX5PC2Z4
AWAITING REVIEW
5aea137ed5dbb3000194f116
17/09/2018, 13:41
00:42:48
NOCODE
AWAITING REVIEW
5aeafd656b4ecd000115adfd
17/09/2018, 13:41
00:36:23
MX5PC2Z4
AWAITING REVIEW
5b0f873bd282ff00015bcd88
17/09/2018, 01:08
N/A
TIMED-OUT
5b0fe50f444cef0001caa108
17/09/2018, 13:43
00:55:13
MX5PC2Z4
AWAITING REVIEW
5b11d226e9270900013c3029
17/09/2018, 01:09
01:00:40
MX5PC2Z4
AWAITING REVIEW
5b1a60332767e20001e4f69b
17/09/2018, 13:42
00:34:05
MX5PC2Z4
AWAITING REVIEW
5b29a5197297750001c75a5b
17/09/2018, 02:45
N/A
TIMED-OUT
5b342c9da2982a0001dd9f25
17/09/2018, 01:08
00:45:48
MX5PC2Z4
AWAITING REVIEW
5b3b48c5b6b4410001614786
17/09/2018, 19:49
N/A
RETURNED
5b48ff52adc1ad0001ba0727
17/09/2018, 19:44
N/A
RETURNED
5b4de5e57b39ce0001cc726b
17/09/2018, 17:43
00:43:30
MX5PC2Z4
AWAITING REVIEW
5b58afe5c6f86f0001c48191
16/09/2018, 14:45
00:53:06
NOCODE
APPROVED
Â£3.00
5b5a1351c83b4d0001b05258
17/09/2018, 02:45
00:42:53
MX5PC2Z4
AWAITING REVIEW
5b5b4fb25d759d0001f0bfd3
17/09/2018, 01:08
N/A
RETURNED
5b5ca33f295c4b0001c294d0
17/09/2018, 17:42
00:36:43
MX5PC2Z4
AWAITING REVIEW
5b65f9e382145800014bb6a3
17/09/2018, 04:30
00:26:06
MX5PC2Z4
AWAITING REVIEW
5b66ce776f0d0400010d678d
17/09/2018, 01:08
N/A
RETURNED
5b6aa9f35331030001359d70
17/09/2018, 13:42
N/A
RETURNED
5b6baad47e435d0001c1c88f '
rawString <- paste(rawString, '5b712a478d336b0001fead58
17/09/2018, 12:15
00:43:01
MX5PC2Z4
AWAITING REVIEW
5b733e7e75c9a9000168ee70
17/09/2018, 17:44
01:11:19
MX5PC2Z4
AWAITING REVIEW
5b89b6ea5548a50001e5bfae
17/09/2018, 19:42
00:44:42
MX5PC2Z4
AWAITING REVIEW
5b89da88bca3400001fa8809
17/09/2018, 01:08
00:44:26
MX5PC2Z4
AWAITING REVIEW
5b8bbd437073290001839123
17/09/2018, 17:42
00:46:39
MX5PC2Z4
AWAITING REVIEW
5b8be3fdcb0fb600011c62d3
17/09/2018, 01:08
00:44:54
MX5PC2Z4
AWAITING REVIEW
5b8bfff214e8c60001052fbd
17/09/2018, 13:43
01:05:54
MX5PC2Z4
AWAITING REVIEW
5b8e962e2c0bef00012521c7
17/09/2018, 17:43
00:36:57
MX5PC2Z4
AWAITING REVIEW
5b90336a8364010001e5e4fd
17/09/2018, 02:45
N/A
TIMED-OUT
5b981db9a2980c0001c4e6fd
17/09/2018, 17:51
00:40:51
MX5PC2Z4
AWAITING REVIEW
5b992b301e665d00017f6a41
17/09/2018, 17:42
01:21:17
MX5PC2Z4
AWAITING REVIEW
5b9ba731e651b300018b133b
16/09/2018, 13:03
02:23:32
Manual Completion
APPROVED
5b9d15d5acc87200010db9d4 ')
source('F:/www/vhosts/localhost/ExploringSocialMetacognition/analysis/advisorChoiceBonuses.R')
if(!require(jsonlite)) {
install.packages("jsonlite")
library(jsonlite)
}
if(!require(BayesFactor)) {
install.packages('BayesFactor')
library(BayesFactor)
}
if(!require(tidyverse)) {
install.packages('tidyverse')
library(tidyverse)
}
if(!require(reshape2)) {
install.packages('reshape2')
library(reshape2)
}
if(!require(lme4)) {
install.packages('lme4')
library(lme4)
}
if(!require(lsr)) {
install.packages('lsr')
library(lsr)
}
if(!require(knitr)) {
install.packages('knitr')
library(knitr)
}
citation("jsonlite")
citation(lme4)
citation("lme4")
citation("knitr")
print(citation('knitr'), bibtex = T)
citation()
system()
r
R.Version()
range(trials$initialConfidence)
df.cumAcc <- NULL
limit <- 0
for(pid in unique(all.trials$pid)) {
tmp <- all.trials[all.trials$pid == pid & all.trials$id > limit & all.trials$practice==F, ]
for(id in unique(tmp$id)) {
df.cumAcc <- rbind (df.cumAcc, data.frame(pid = as.factor(pid),
id,
cumAcc = mean(tmp$initialCorrect[tmp$id<=id])))
}
}
gg.cumAcc <- ggplot(df.cumAcc, aes(x = id, y = cumAcc, colour = pid)) +
geom_line(alpha = 0.25) +
stat_summary(geom = 'line', fun.y = mean, colour = 'red') +
stat_summary(geom = 'ribbon', fun.data = mean_cl_normal, colour = NA, fill = 'red', alpha = 0.05) +
annotate(geom = 'text', label = c('Mean', 'CL95% Low', 'CL95% High'),
y = c(.625,.575,.525), x = 230, hjust = 1) +
annotate(geom = 'text',
label = paste(round(mean_cl_normal(df.cumAcc$cumAcc[df.cumAcc$id==max(df.cumAcc$id)]),3)),
y = c(.625,.575,.525), x = 240) +
geom_hline(yintercept = .71, linetype = 'dashed', colour = 'black', size = 1) +
scale_y_continuous(limits=c(0.5,1),breaks=seq(0,1,.05)) +
style.long +
labs(title = 'Cumulative accuracy plot for participants in the Advisor Choice (accuracy) task')
gg.cumAcc
